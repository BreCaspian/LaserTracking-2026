%YAML:1.0

# 四种组合总有一组是对的
yaw_sign: -1.0    # yaw方向符号（左正右负 => -1）
pitch_sign: -1.0  # pitch方向符号（实测收敛为 -1）

# --- 丝滑稳定响应版本（有点慢） ---
# kp: 0.7                   # 角度P增益（稳态优先）
# deadband_px: 4.0          # 像素死区（稳态优先）
# max_angle_rate: 30.0      # 最大角速度(deg/s)（稳态优先）
# lowpass_alpha: 0.25       # 输出低通系数（稳态优先）
# ctrl_dt_nominal_ms: 10.0  # 控制周期名义值(ms)
# ctrl_dt_min_ms: 2.0       # 控制周期最小值(ms)
# ctrl_dt_max_ms: 50.0      # 控制周期最大值(ms)
# use_velocity_ff: 1        # 前馈开关(只发送不注入)
# ff_alpha: 0.25            # 前馈低通系数（稳态优先）
# ff_rate_max: 60.0         # 前馈限幅(deg/s)（稳态优先）
# ff_dt_max_ms: 50.0        # 前馈dt上限(ms)

# --- 快速响应版本（可能更抖，但快） ---
kp: 1.2
deadband_px: 1.0
max_angle_rate: 180.0
lowpass_alpha: 0.45
ctrl_dt_nominal_ms: 10.0
ctrl_dt_min_ms: 1.0
ctrl_dt_max_ms: 100.0

# 前馈
use_velocity_ff: 1
ff_alpha: 0.25
ff_rate_max: 150.0
ff_dt_max_ms: 80.0

# 阻尼
# damping_source: "meas" 使用测量速度，更快；"gimbal" 使用云台角速度反馈，更稳定
use_damping: 1          # 0=关闭 1=开启
damping_source: "meas"
damping_kd: 0.02         # seconds, 0.02~0.08 常用
damping_dt_max_ms: 120  # 测量速度最大时间间隔(ms)  means模式下生效


# --- 丢失目标搜索模式（平滑画圆） ---
scan_enable: 1        # 0=关闭 1=开启
scan_radius_deg: 12.0 # 画圆半径(度)  ！！！注意 半径太大视野中心会出现视野死区
scan_rate_hz: 0.2     # 转一圈频率(Hz)

# --- 搜索策略选择 ---
scan_pattern: "spiral"  # circle | spiral

# --- 丢失目标搜索模式（恒路径速度扩张螺线） ---  针对 CS200 通过量化计算获得的理论最优参数组合
# scan_spacing_deg: 8.05      # 螺线圈间距(度)
# scan_speed_deg_s: 20.0      # 路径速度(度/秒)
# scan_r_max_deg: 20.0        # 最大半径(度)
# scan_spiral_return: 0       # 0=只外扩 1=到r_max后沿原路径返回并往复
# scan_k_yaw: 1.5             # 椭圆比例yaw
# scan_k_pitch: 1.0           # 椭圆比例pitch
# scan_enter_delay_ms: 180    # 进入搜索延迟(ms)
# scan_reacq_confirm_frames: 2  # 重获确认帧数

scan_spacing_deg: 6.05      # 螺线圈间距(度)
scan_speed_deg_s: 25.0      # 路径速度(度/秒)
scan_r_max_deg: 15.0        # 最大半径(度)
scan_spiral_return: 0       # 0=只外扩 1=到r_max后沿原路径返回并往复
scan_k_yaw: 2.5             # 椭圆比例yaw  左右看得多更宽
scan_k_pitch: 0.75          # 椭圆比例pitch  上下看得多
scan_enter_delay_ms: 180    # 进入搜索延迟(ms)
scan_reacq_confirm_frames: 2  # 重获确认帧数

# --- 启动两帧策略 ---
startup_check_frames: 5  # 前N次控制循环内未见目标则回正
startup_home_pitch: 0.0  # 回正pitch(度)
startup_home_yaw: 0.0    # 回正yaw(度)

# --- 启动准备阶段（1秒） ---
startup_prep_ms: 1000        # 启动准备总时长(ms)，>0启用
startup_hold_ms: 200         # 保持当前姿态(ms)
startup_home_ms: 600         # 回正阶段(ms)
startup_validate_ms: 200     # 稳定/校验(ms)
startup_min_state_frames: 1  # 至少收到的云台回传帧数
startup_require_home: 1      # 未回到home不进入搜索
startup_home_tol_deg: 1.0    # home容差(度)
startup_home_max_extra_ms: 1000 # 允许额外回正时间(ms)
startup_validate_first: 1    # 校验阶段在回正前执行
startup_allow_early_exit: 1  # 校验阶段若检测到目标则跳过回正

# --- 相机内参与 boresight ---
fx: 18346.21567737546   # 内参fx
fy: 18215.638701919743  # 内参fy
cx: 2182.156707136921   # 内参cx
cy: 3645.5080162494414  # 内参cy
# u_L: 2736               # boresight u（图像中心，临时验证用）使用同轴校准工具推荐初始设置
# v_L: 1824               # boresight v（图像中心，临时验证用）


u_L: 2.8753500000000004e+03  # 上赛场必须根据实际距离进行同轴矫正，现在只能用于测试
v_L: 1.9223999999999999e+03